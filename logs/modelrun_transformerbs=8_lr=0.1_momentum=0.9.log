log file path: D:\Uni\Thesis\NEWREPO\multimodal-cardiography-learning\logs\TorchECG_05-04_01-09_ECG_CRNN_adamw_amsgrad_LR_0.0001_BS_8_resnet_nature_comm_bottle_neck.txt
TorchECG - INFO - training configurations are as follows:
{
    "debug": True,
    "final_model_name": None,
    "log_step": 20,
    "flooding_level": 0.0,
    "early_stopping": {
        "min_delta": 0.001,
        "patience": 10
    },
    "log_dir": "logs",
    "checkpoints": checkpoints,
    "model_dir": None,
    "working_dir": "",
    "prefix": "TorchECG",
    "DTYPE": DTYPE(STR='float32', NP=dtype('float32'), TORCH=torch.float32, INT=32),
    "str_dtype": "float32",
    "np_dtype": float32,
    "dtype": torch.float32,
    "device": cuda,
    "eps": 1e-07,
    "SEED": 42,
    "RNG": Generator(PCG64),
    "RNG_sample": functools.partial(<built-in method choice of numpy.random._generator.Generator object at 0x000001C962619D68>, replace=False, shuffle=False),
    "RNG_randint": functools.partial(<built-in method integers of numpy.random._generator.Generator object at 0x000001C962619D68>, endpoint=True),
    "set_seed": <function set_seed at 0x000001C962656288>,
    "change_dtype": <function change_dtype at 0x000001C96265D558>,
    "classes": [
        "N",
        "A"
    ],
    "n_epochs": 100,
    "batch_size": 8,
    "optimizer": "adamw_amsgrad",
    "momentum": 0.949,
    "betas": [
        0.9, 0.999
    ],
    "decay": 0.01,
    "learning_rate": 0.0001,
    "lr": 0.0001,
    "lr_scheduler": "one_cycle",
    "lr_step_size": 50,
    "lr_gamma": 0.1,
    "max_lr": 0.002,
    "burn_in": 400,
    "steps": [
        5000, 10000
    ],
    "loss": "AsymmetricLoss",
    "loss_kw": {
        "gamma_pos": 0,
        "gamma_neg": 0.2,
        "implementation": "deep-psp"
    },
    "monitor": "challenge_metric",
    "eval_every": 20,
    "cnn_name": "transformer",
    "rnn_name": "none",
    "attn_name": "none",
    "input_len": 16000,
    "input_len_tol": 3200,
    "sig_slice_tol": 0.4,
    "siglen": 16000,
    "physionetOnly": True
}
** ECGPCG DATASET HEAD:   filename og_filename  label  record_duration  num_channels  samples_ecg  samples_pcg  qrs_count  seg_num     avg_hr
0    a0001       a0001      1          35.6660             1        71332        71332         73        4  142.20499
1    a0002       a0002      1          20.8285             1        41657        41657         54        2  168.61365
2    a0003       a0003      1          30.7200             1        61440        61440         51        3  170.23572
3    a0004       a0004      1          35.5965             1        71193        71193         67        4  141.67530
4    a0005       a0005      1          35.6660             1        71332        71332        104        4  208.28456 **
* Validating directories and files for: 
['data-after-TEST/physionet/data_ecg_cwt/', 'data-after-TEST/ephnogram/data_ecg_cwt/']
['data-after-TEST/physionet/data_pcg_cwt/', 'data-after-TEST/ephnogram/data_pcg_cwt/']
['data-after-TEST/physionet/data_physionet_raw', 'data-after-TEST/ephnogram/data_ephnogram_raw']


* Successfully validated all ECG and PCG directories and files.
Incomplete samples (missing ECG/PCG/both, missing files, missing segments): ['data-after-TEST/physionet/data_ecg_cwt/a0315']
0: ['data-after-TEST/physionet/data_ecg_cwt/a0001/0/a0001_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0001/1/a0001_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0001/2/a0001_seg_2_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0001/3/a0001_seg_3_cwt.npz']
1: ['data-after-TEST/physionet/data_ecg_cwt/a0002/0/a0002_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0002/1/a0002_seg_1_cwt.npz']
2: ['data-after-TEST/physionet/data_ecg_cwt/a0003/0/a0003_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0003/1/a0003_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0003/2/a0003_seg_2_cwt.npz']
5: ['data-after-TEST/physionet/data_ecg_cwt/a0006/0/a0006_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0006/1/a0006_seg_1_cwt.npz']
11: ['data-after-TEST/physionet/data_ecg_cwt/a0012/0/a0012_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0012/1/a0012_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0012/2/a0012_seg_2_cwt.npz']
12: ['data-after-TEST/physionet/data_ecg_cwt/a0013/0/a0013_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0013/1/a0013_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0013/2/a0013_seg_2_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0013/3/a0013_seg_3_cwt.npz']
self.ecg_paths: 2801 len(sum(self.ecg_paths, [])): 2803
ECGPCG DATASET LABELS HEAD:   filename  label
0    a0001      1
1    a0002      1
2    a0003      1
3    a0004      1
4    a0005      1
ECGPCG DATASET LENGTH (EXISTING): 2801, TARGET LENGTH (INCLUDING MISSING/INCOMPLETE): 2803
len data_train, data_test: 1960 841
len val_dataset, val_train_dataset: 841 1960
len(self.data_source): <torch.utils.data.dataset.Subset object at 0x000001C96FB532C8>
len(self.data_source): <torch.utils.data.dataset.Subset object at 0x000001C96FB532C8>
len(self.data_source): <torch.utils.data.dataset.Subset object at 0x000001C96ACF2448>
log file path: D:\Uni\Thesis\NEWREPO\multimodal-cardiography-learning\logs\TorchECG_05-04_01-09_ECG_CRNN_adamw_amsgrad_LR_0.0001_BS_8_resnet_nature_comm_bottle_neck.txt
TorchECG - INFO - training configurations are as follows:
{
    "debug": True,
    "final_model_name": None,
    "log_step": 20,
    "flooding_level": 0.0,
    "early_stopping": {
        "min_delta": 0.001,
        "patience": 10
    },
    "log_dir": "logs",
    "checkpoints": checkpoints,
    "model_dir": None,
    "working_dir": "",
    "prefix": "TorchECG",
    "DTYPE": DTYPE(STR='float32', NP=dtype('float32'), TORCH=torch.float32, INT=32),
    "str_dtype": "float32",
    "np_dtype": float32,
    "dtype": torch.float32,
    "device": cuda,
    "eps": 1e-07,
    "SEED": 42,
    "RNG": Generator(PCG64),
    "RNG_sample": functools.partial(<built-in method choice of numpy.random._generator.Generator object at 0x000001C962619D68>, replace=False, shuffle=False),
    "RNG_randint": functools.partial(<built-in method integers of numpy.random._generator.Generator object at 0x000001C962619D68>, endpoint=True),
    "set_seed": <function set_seed at 0x000001C962656288>,
    "change_dtype": <function change_dtype at 0x000001C96265D558>,
    "classes": [
        "N",
        "A"
    ],
    "n_epochs": 100,
    "batch_size": 8,
    "optimizer": "adamw_amsgrad",
    "momentum": 0.949,
    "betas": [
        0.9, 0.999
    ],
    "decay": 0.01,
    "learning_rate": 0.0001,
    "lr": 0.0001,
    "lr_scheduler": "one_cycle",
    "lr_step_size": 50,
    "lr_gamma": 0.1,
    "max_lr": 0.002,
    "burn_in": 400,
    "steps": [
        5000, 10000
    ],
    "loss": "AsymmetricLoss",
    "loss_kw": {
        "gamma_pos": 0,
        "gamma_neg": 0.2,
        "implementation": "deep-psp"
    },
    "monitor": "challenge_metric",
    "eval_every": 20,
    "cnn_name": "transformer",
    "rnn_name": "none",
    "attn_name": "none",
    "input_len": 16000,
    "input_len_tol": 3200,
    "sig_slice_tol": 0.4,
    "siglen": 16000,
    "physionetOnly": True
}
** ECGPCG DATASET HEAD:   filename og_filename  label  record_duration  num_channels  samples_ecg  samples_pcg  qrs_count  seg_num     avg_hr
0    a0001       a0001      1          35.6660             1        71332        71332         73        4  142.20499
1    a0002       a0002      1          20.8285             1        41657        41657         54        2  168.61365
2    a0003       a0003      1          30.7200             1        61440        61440         51        3  170.23572
3    a0004       a0004      1          35.5965             1        71193        71193         67        4  141.67530
4    a0005       a0005      1          35.6660             1        71332        71332        104        4  208.28456 **
* Validating directories and files for: 
['data-after-TEST/physionet/data_ecg_cwt/', 'data-after-TEST/ephnogram/data_ecg_cwt/']
['data-after-TEST/physionet/data_pcg_cwt/', 'data-after-TEST/ephnogram/data_pcg_cwt/']
['data-after-TEST/physionet/data_physionet_raw', 'data-after-TEST/ephnogram/data_ephnogram_raw']


* Successfully validated all ECG and PCG directories and files.
Incomplete samples (missing ECG/PCG/both, missing files, missing segments): ['data-after-TEST/physionet/data_ecg_cwt/a0315']
0: ['data-after-TEST/physionet/data_ecg_cwt/a0001/0/a0001_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0001/1/a0001_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0001/2/a0001_seg_2_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0001/3/a0001_seg_3_cwt.npz']
1: ['data-after-TEST/physionet/data_ecg_cwt/a0002/0/a0002_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0002/1/a0002_seg_1_cwt.npz']
2: ['data-after-TEST/physionet/data_ecg_cwt/a0003/0/a0003_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0003/1/a0003_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0003/2/a0003_seg_2_cwt.npz']
5: ['data-after-TEST/physionet/data_ecg_cwt/a0006/0/a0006_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0006/1/a0006_seg_1_cwt.npz']
11: ['data-after-TEST/physionet/data_ecg_cwt/a0012/0/a0012_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0012/1/a0012_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0012/2/a0012_seg_2_cwt.npz']
12: ['data-after-TEST/physionet/data_ecg_cwt/a0013/0/a0013_seg_0_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0013/1/a0013_seg_1_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0013/2/a0013_seg_2_cwt.npz', 'data-after-TEST/physionet/data_ecg_cwt/a0013/3/a0013_seg_3_cwt.npz']
self.ecg_paths: 2801 len(sum(self.ecg_paths, [])): 2803
ECGPCG DATASET LABELS HEAD:   filename  label
0    a0001      1
1    a0002      1
2    a0003      1
3    a0004      1
4    a0005      1
ECGPCG DATASET LENGTH (EXISTING): 2801, TARGET LENGTH (INCLUDING MISSING/INCOMPLETE): 2803
len data_train, data_test: 1960 841
len val_dataset, val_train_dataset: 841 1960
len(self.data_source): <torch.utils.data.dataset.Subset object at 0x000001C96AB74B08>
len(self.data_source): <torch.utils.data.dataset.Subset object at 0x000001C96AB74B08>
len(self.data_source): <torch.utils.data.dataset.Subset object at 0x000001C96AB74D88>
TorchECG - INFO - 
Starting training:
------------------
Epochs:          100
Batch size:      8
Learning rate:   0.0001
Training size:   1960
Validation size: 841
Device:          cuda
Optimizer:       adamw_amsgrad
Dataset classes: ['N', 'A']
-----------------------------------------

TorchECG - INFO - Train epoch_0:
--------------------------------------------------------------------------------------------------------------
